<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="xywx.mapping.StatisticsDao">
	<resultMap id="BaseResultMap" type="xywx.dao.Statistics">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Tue Apr 26 
			21:13:32 CST 2016. -->
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="name" property="type" jdbcType="VARCHAR" />
		<result column="location" property="location" jdbcType="VARCHAR" />
		<result column="open_id" property="open_id" jdbcType="VARCHAR" />
		<result column="career" property="career" jdbcType="VARCHAR" />
		<result column="place" property="place" jdbcType="VARCHAR" />
		<result column="testid" property="testid" jdbcType="INTEGER" />
		<result column="testtime" property="testtime" jdbcType="TIMESTAMP" />
		<result column="energy" property="energy" jdbcType="INTEGER" />
		<result column="gender" property="gender" jdbcType="INTEGER" />
		<result column="age" property="age" jdbcType="INTEGER" />
		
	</resultMap>

	<select id="selectStatistics" resultType="xywx.dao.Statistics" parameterType="xywx.dao.Statistics">
		SELECT
		cus.id,cus.`name`,cus.gender,cus.age,cus.openid,cus.career,cus.place,te.id
		as testid,te.testtime,te.energy from test te LEFT JOIN customer cus on
		cus.id=te.customerid where 1=1
		<if test="gender!=null and gender!=''">
		and cus.gender=#{gender}
		</if>
		<if test="age!=null and age!=''">
		and cus.age=#{age}
		</if>
		<if test="career!=null and career!=''">
		and cus.career=#{career}
		</if>
		<if test="place!=null and place!=''">
		and cus.place=#{place}
		</if>
		<if test="name!=null and name!=''">
		and cus.name like '%${name}%'
		</if>
		<if test="begintime!=null and begintime!=''">
		and te.testtime &gt;= #{begintime}
		</if>
		<if test="endtime!=null and endtime!=''">
		and te.testtime &lt;= #{endtime}
		</if>
		order by te.testtime desc
	</select>


</mapper>